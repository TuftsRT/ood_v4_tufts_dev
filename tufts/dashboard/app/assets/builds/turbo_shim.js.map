{
  "version": 3,
  "sources": ["../../javascript/utils.js", "../../javascript/alert.js", "../../javascript/turbo_shim.js"],
  "sourcesContent": ["import {analyticsPath} from \"./config\";\n\nexport function cssBadgeForState(state){\n  switch (state) {\n    case 'completed':\n      return 'bg-success';\n    case 'running':\n      return 'bg-primary'\n    case 'queued':\n      return 'bg-info';\n    case 'queued_held':\n      return 'bg-warning';\n    case 'suspended':\n      return 'bg-warning';\n    default:\n      return 'bg-warning';\n  }\n}\n\nexport function capitalizeFirstLetter(string) {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n}\n\nexport function startOfYear() {\n  const now = new Date();\n  const past = new Date();\n  past.setDate(1);\n  past.setMonth(0);\n  past.setFullYear(now.getFullYear());\n  return `${past.getFullYear()}-${past.getMonth()+1}-${past.getDate()}`;\n}\n\nexport function thirtyDaysAgo() {\n  const now = new Date();\n  const past = new Date();\n  past.setDate(now.getDate() - 30);\n  return `${past.getFullYear()}-${past.getMonth()+1}-${past.getDate()}`;\n}\n\nexport function today() {\n  const now = new Date();\n  return `${now.getFullYear()}-${now.getMonth()+1}-${now.getDate()}`;\n}\n\nfunction showSpinner() {\n  $('body').addClass('modal-open');\n  $('#full-page-spinner').removeClass('d-none');\n}\n\nexport function bindFullPageSpinnerEvent() {\n  $('.full-page-spinner').each((index, element) => {\n    const $element = $(element);\n    if($element.is('a')) {\n      $element.on('click', showSpinner);\n    } else {\n      $element.closest('form').on('submit', showSpinner);\n    }\n  });\n}\n\n// open links in javascript and display an alert\nexport function openLinkInJs(event) {\n  event.preventDefault();\n  let href = event.target.href;\n\n  // event.target could be a child of the anchor, so try that.\n  if(href == null) {\n    const closestAnchor = event.target.closest('a');\n    if(closestAnchor.hasChildNodes(event.target)) {\n      href = closestAnchor.href;\n    } else {\n      // event.target is not a child of an anhcor, so there's nothing to do.\n      return;\n    }\n  }\n\n  if(window.open(href) == null) {\n    // link was not opened in new window, so display error msg to user\n    const html = document.getElementById('js-alert-danger-template').innerHTML;\n    const msg = \"This link is configured to open in a new window, but it doesn't seem to have opened. \" +\n          \"Please disable your popup blocker for this page and try again.\";\n\n    // replace message in alert and add to main div of layout\n    const mainDiv = document.querySelectorAll('div[role=\"main\"]')[0];\n    const alertDiv = document.createElement('div');\n    alertDiv.innerHTML = html.split(\"ALERT_MSG\").join(msg);\n    mainDiv.prepend(alertDiv);\n  }\n}\n\n// Helper method to set an element's innerHTML property\n// and evaluate any <script> tags that may exist within it.\n// Just setting innerHTML of an html element does not re-evaluate\n// the <script> tags that it may hold.\nexport function setInnerHTML(element, html) {\n  element.innerHTML = html;\n  const scripts = Array.from(element.querySelectorAll(\"script\"));\n\n  scripts.forEach(currentElement => {\n    const newElement = document.createElement(\"script\");\n\n    Array.from(currentElement.attributes).forEach( attr => {\n      newElement.setAttribute(attr.name, attr.value);\n    });\n\n    const scriptText = document.createTextNode(currentElement.innerHTML);\n    newElement.appendChild(scriptText);\n\n    currentElement.parentNode.replaceChild(newElement, currentElement);\n  });\n}\n\n// Helper method to report errors from the front end via AJAX\nexport function reportErrorForAnalytics(path, error) {\n  // error - report back for analytics purposes\n  const analyticsUrl = new URL(analyticsPath(path), document.location);\n  analyticsUrl.searchParams.append('error', error);\n  // Fire and Forget\n  fetch(analyticsUrl);\n}\n\n// helper method to hide an element. Note that jQuery's hide()\n// changes the inline style which may not do anything if the element\n// already has a bootstrap display class like d-flex.\nexport function hide(id) {\n  const ele = document.getElementById(id);\n  if(ele !== null) {\n    ele.classList.add('d-none');\n  }\n}\n\n// helper method to show an element. Note that jQuery's show()\n// changes the inline style which may not do anything if the element\n// already has a bootstrap display class like d-flex.\nexport function show(id) {\n  const ele = document.getElementById(id);\n  if(ele !== null) {\n    ele.classList.remove('d-none');\n  }\n}\n", "\nexport function alert(message) {\n  const div = alertDiv(message);\n  const main = document.getElementById('main_container');\n  main.prepend(div);\n  div.scrollIntoView({ behavior: 'smooth' });\n}\n\nfunction alertDiv(message) {\n  const span = document.createElement('span');\n  span.innerText = message;\n\n  const div = document.createElement('div');\n  div.classList.add('alert', 'alert-danger', 'alert-dismissible');\n  div.setAttribute('role', 'alert');\n  div.appendChild(span);\n  div.appendChild(closeButton());\n\n  return div;\n}\n\nfunction closeButton() {\n  const button = document.createElement('button');\n  button.classList.add('btn-close');\n  button.dataset.bsDismiss = 'alert';\n\n  const span = document.createElement('span');\n  span.classList.add('sr-only');\n  span.innerText = 'Close';\n\n  button.appendChild(span);\n\n  return button;\n}", "\n/*\n  While we want Turbo enabled at some point,\n  it doesn't really work well yet. So, we'll provide\n  this shim until we enable it.\n*/\n\nimport { setInnerHTML } from './utils';\nimport { alert } from './alert';\n\nexport function replaceHTML(id, html) {\n  const ele = document.getElementById(id);\n\n  if(ele == null){\n    return;\n  } else {\n    var tmp = document.createElement('div');\n    tmp.innerHTML = html;\n    const newHTML = tmp.querySelector('template').innerHTML;\n    tmp.remove();\n\n    setInnerHTML(ele, newHTML);\n  }\n}\n\nexport function pollAndReplace(url, delay, id, callback) {\n  fetch(url, { headers: { Accept: \"text/vnd.turbo-stream.html\" } })\n    .then((response) => {\n      if(response.status == 200) {\n        return Promise.resolve(response);\n      } else if(response.status == 401) {\n        return Promise.reject(\"This page cannot update becase you are no longer authenticated. Please refresh the page to log back in.\")\n      } else {\n        return Promise.reject(response.text());\n      }\n    })\n    .then((r) => r.text())\n    .then((html) => replaceHTML(id, html))\n    .then(() => {\n      setTimeout(pollAndReplace, delay, url, delay, id, callback);\n      if (typeof callback == 'function') {\n        callback();\n      }\n    })\n    .catch((err) => {\n      if (typeof err == 'string') {\n        alert(err);\n      } else {\n        alert('This page has encountered an unexpected error. Please refresh the page.');\n      }\n      console.log(err);\n    });\n}\n"],
  "mappings": "AA8FO,SAASA,EAAaC,EAASC,EAAM,CAC1CD,EAAQ,UAAYC,EACJ,MAAM,KAAKD,EAAQ,iBAAiB,QAAQ,CAAC,EAErD,QAAQE,GAAkB,CAChC,IAAMC,EAAa,SAAS,cAAc,QAAQ,EAElD,MAAM,KAAKD,EAAe,UAAU,EAAE,QAASE,GAAQ,CACrDD,EAAW,aAAaC,EAAK,KAAMA,EAAK,KAAK,CAC/C,CAAC,EAED,IAAMC,EAAa,SAAS,eAAeH,EAAe,SAAS,EACnEC,EAAW,YAAYE,CAAU,EAEjCH,EAAe,WAAW,aAAaC,EAAYD,CAAc,CACnE,CAAC,CACH,CC7GO,SAASI,EAAMC,EAAS,CAC7B,IAAMC,EAAMC,EAASF,CAAO,EACf,SAAS,eAAe,gBAAgB,EAChD,QAAQC,CAAG,EAChBA,EAAI,eAAe,CAAE,SAAU,QAAS,CAAC,CAC3C,CAEA,SAASC,EAASF,EAAS,CACzB,IAAMG,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,UAAYH,EAEjB,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxC,OAAAA,EAAI,UAAU,IAAI,QAAS,eAAgB,mBAAmB,EAC9DA,EAAI,aAAa,OAAQ,OAAO,EAChCA,EAAI,YAAYE,CAAI,EACpBF,EAAI,YAAYG,EAAY,CAAC,EAEtBH,CACT,CAEA,SAASG,GAAc,CACrB,IAAMC,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,UAAU,IAAI,WAAW,EAChCA,EAAO,QAAQ,UAAY,QAE3B,IAAMF,EAAO,SAAS,cAAc,MAAM,EAC1C,OAAAA,EAAK,UAAU,IAAI,SAAS,EAC5BA,EAAK,UAAY,QAEjBE,EAAO,YAAYF,CAAI,EAEhBE,CACT,CCvBO,SAASC,EAAYC,EAAIC,EAAM,CACpC,IAAMC,EAAM,SAAS,eAAeF,CAAE,EAEtC,GAAGE,GAAO,KAEH,CACL,IAAIC,EAAM,SAAS,cAAc,KAAK,EACtCA,EAAI,UAAYF,EAChB,IAAMG,EAAUD,EAAI,cAAc,UAAU,EAAE,UAC9CA,EAAI,OAAO,EAEXE,EAAaH,EAAKE,CAAO,CAC3B,CACF,CAEO,SAASE,EAAeC,EAAKC,EAAOR,EAAIS,EAAU,CACvD,MAAMF,EAAK,CAAE,QAAS,CAAE,OAAQ,4BAA6B,CAAE,CAAC,EAC7D,KAAMG,GACFA,EAAS,QAAU,IACb,QAAQ,QAAQA,CAAQ,EACvBA,EAAS,QAAU,IACpB,QAAQ,OAAO,yGAAyG,EAExH,QAAQ,OAAOA,EAAS,KAAK,CAAC,CAExC,EACA,KAAMC,GAAMA,EAAE,KAAK,CAAC,EACpB,KAAMV,GAASF,EAAYC,EAAIC,CAAI,CAAC,EACpC,KAAK,IAAM,CACV,WAAWK,EAAgBE,EAAOD,EAAKC,EAAOR,EAAIS,CAAQ,EACtD,OAAOA,GAAY,YACrBA,EAAS,CAEb,CAAC,EACA,MAAOG,GAAQ,CACV,OAAOA,GAAO,SAChBC,EAAMD,CAAG,EAETC,EAAM,yEAAyE,EAEjF,QAAQ,IAAID,CAAG,CACjB,CAAC,CACL",
  "names": ["setInnerHTML", "element", "html", "currentElement", "newElement", "attr", "scriptText", "alert", "message", "div", "alertDiv", "span", "closeButton", "button", "replaceHTML", "id", "html", "ele", "tmp", "newHTML", "setInnerHTML", "pollAndReplace", "url", "delay", "callback", "response", "r", "err", "alert"]
}
