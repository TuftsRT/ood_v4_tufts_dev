var f="ood_config";function m(){return document.getElementById(f).dataset}function u(){let e=m().rootPath;return e=="/"?e:e.substring(0,e.length-1)}function d(t,e){t.innerHTML=e,Array.from(t.querySelectorAll("script")).forEach(o=>{let n=document.createElement("script");Array.from(o.attributes).forEach(c=>{n.setAttribute(c.name,c.value)});let a=document.createTextNode(o.innerHTML);n.appendChild(a),o.parentNode.replaceChild(n,o)})}function i(t,e){let r=document.getElementById(t);if(r!=null){var o=document.createElement("div");o.innerHTML=e;let n=o.querySelector("template").innerHTML;o.remove(),d(r,n)}}jQuery(function(){$('[data-job-poller="true"]').each((t,e)=>{p(e)}),$("[data-bs-toggle='project']").each((t,e)=>{D(e)})});function g(t,e){let r=u(),n=document.getElementById("project_config").dataset.projectId;return`${r}/projects/${n}/jobs/${t}/${e}`}function p(t){let e=t.dataset.jobCluster,r=t.dataset.jobId;if(e===void 0||r===void 0)return;let o=g(e,r);fetch(o,{headers:{Accept:"text/vnd.turbo-stream.html"}}).then(n=>n.ok?Promise.resolve(n):Promise.reject(n.text())).then(n=>n.text()).then(n=>{let a=t.querySelector(`#${t.id}_data`),c=!1,s=h(n);a!=null&&(c=a.classList.contains("show")),c&&s.querySelector(`#${t.id}_data`).classList.add("show");let l=s.dataset.jobStatus;return l==="completed"?x(t.id,s.outerHTML):i(t.id,s.outerHTML),l}).then(n=>{n!="completed"&&setTimeout(p,3e4,t)}).catch(n=>{console.log("Cannot not retrive job details due to error:"),console.log(n)})}function h(t){let e=document.createElement("template");return e.innerHTML=t.trim(),e.content.firstChild}function x(t,e){let r=document.getElementById(t);r!==null&&r.remove();let o=document.createElement("div");o.id=t,o.classList.add("col-md-4"),document.getElementById("completed_jobs").appendChild(o),i(t,e)}function D(t){let e="Undetermined Size",r=$(t),o=r.data("url");$.ajax({url:o,type:"GET",headers:{Accept:"application/json"},success:function(n){let a=n.size===0?e:n.human_size;r.text(`(${a})`)},error:function(n,a,c){console.log(`An error occurred getting project size!
`+c),r.text(`(${e})`)}})}
//# sourceMappingURL=projects.js.map
