var x,u={bc_num_hours:{label:"Hours",help:"How long the job can run for."},auto_queues:{label:"Queues",help:"Which queue the job will submit too."},auto_accounts:{label:"Account",help:"The account the job will be submitted with."},auto_job_name:{label:"Job Name",help:"The name the job will have."},auto_log_location:{label:"Log Location",help:"The destination of the job's log output."},bc_num_slots:{label:"Nodes",help:"How many nodes the job will run on."},auto_environment_variable:{label:"Environment Variable",help:"Add an environment variable."},auto_cores:{label:"Cores",help:"How many cores the job will run on."}};function m(){return $("#add_new_field_button")}function b(){let e=m();for(let t in u)if(document.getElementById(`launcher_${t}`)===null){e.text("Add new option"),e.attr("disabled",!1);return}e.text("No more options")}function A(e){let t=m();t.attr("disabled",!0),t.before(x.html());let n=t.prev(),l=n.find(".btn-danger"),i=n.find(".btn-success"),o=n.find("select");l.on("click",a=>{I(a)}),i.on("click",a=>{T(a)}),o.on("change",a=>{h(a)}),O(o.get(0)),h({target:o.get(0)})}function O(e){for(let t in u)if(document.getElementById(`launcher_${t}`)===null){let l=document.createElement("option");l.value=t,l.text=u[t].label,e.add(l)}}function h(e){let t=u[e.target.value].help,l=e.target.parentElement.parentElement.firstElementChild;l.innerText=t}function I(e){e.target.parentElement.parentElement.parentElement.remove(),b()}function v(e){e.target.parentElement.remove(),b()}function E(e){let t=e.target.parentElement;t.querySelector(".edit-group").classList.remove("d-none");let l=t.querySelector(".btn-success"),i=t.querySelector(".btn-primary");l.classList.remove("d-none"),i.disabled=!0,l.onclick=o=>{L(o)}}function L(e){let t=e.target.parentElement;t.querySelector(".edit-group").classList.add("d-none");let l=t.querySelector(".btn-success"),i=t.querySelector(".btn-primary");l.classList.add("d-none"),i.disabled=!1}function T(e){let n=e.target.parentElement.parentElement.firstElementChild.value,l=$(`#${n}_template`),i=m();i.before(l.html());let o=i.prev();o.find(".btn-danger").on("click",d=>{v(d)}),o.find(".btn-primary").on("click",d=>{E(d)}),o.find("[data-select-toggler]").on("click",d=>{w(d)}),o.find("[data-fixed-toggler]").on("click",d=>{F(d)}),o.find('[data-auto-environment-variable="name"]').on("keyup",d=>{_(d)}),e.target.parentElement.parentElement.parentElement.remove(),b()}function _(e){let t=e.target.value,n=e.target.dataset.labelString,l=`launcher_auto_environment_variable_${t}`,i=`launcher[auto_environment_variable_${t}]`;var o=e.target.parentElement.children[2].children[1];if(o.removeAttribute("readonly"),o.id=l,o.name=i,n.match(/Environment(&#32;|\s)Variable/)){let f=e.target.parentElement.children[2].children[0];f.innerHTML=`Environment Variable: ${t}`}let a=e.target.parentElement.children[3].children[0].children[0],d=a.children[0];d.id=`${l}_fixed`,d.name=`launcher[auto_environment_variable_${t}_fixed]`,d.setAttribute("data-fixed-toggler",l);let c=2;if(a.children.length==3){let f=a.children[1];f.name=i}else c=1;a.children[c].setAttribute("for",`${l}_fixed`)}function S(e){let t=e.dataset.excludeId,l=Array.from(e.options).filter(o=>!o.selected).map(o=>o.text),i=document.getElementById(t);i.value=l.join(",")}function y(e,t){t.disabled=!0;let n=$("<input>").attr("type","hidden").attr("name",t.name).attr("value",t.value);if($(e).after(n),t.nodeName=="SELECT"){let i=Array.from(t.options).filter(a=>a.selected)[0];$(t).parents(".editable-form-field").find("li.list-group-item").get().forEach(a=>{let d=$(a).find("[data-select-value]")[0].textContent;i.text==d?s(a,!0):p(a,!0)})}}function F(e){e.target.disabled=!0;let t=e.target.dataset.fixedToggler,n=document.getElementById(t);e.target.checked?y(e.target,n):(n.disabled=!1,$(`input[type=hidden][name="${n.name}"]`).remove(),n.nodeName=="SELECT"&&(S(n),k(n))),e.target.disabled=!1}function p(e,t=!1){e.classList.add("list-group-item-danger","text-strike");let n=$(e).find('[data-select-toggler="add"]')[0];n.disabled=t;let l=$(e).find('[data-select-toggler="remove"]')[0];l.disabled=!0}function s(e,t=!1){e.classList.remove("list-group-item-secondary","list-group-item-danger","text-strike");let n=$(e).find('[data-select-toggler="add"]')[0];n.disabled=!0;let l=$(e).find('[data-select-toggler="remove"]')[0];l.disabled=t}function w(e){let t=e.target.dataset.selectToggler,n=e.target.parentElement;e.target.disabled=!0;let l=$(n).find("[data-select-value]")[0].textContent,i=document.getElementById(e.target.dataset.selectId),o=i.dataset.excludeId,a=Array.from(i.options),d=a.filter(r=>r.text==l)[0],c=a.filter(r=>!r.disabled);t=="add"?(s(n),j(o,l),d.disabled=!1):(p(n),D(o,l),d.disabled=!0,d.selected&&(d.selected=!1,c.filter(r=>r.text!==l)[0].selected=!0)),B(n.parentElement)}function B(e){let t=Array.from(e.children),n=Array.from(t.filter(l=>!l.classList.contains("text-strike")));if(n.length>1){let l=n.filter(i=>i.querySelectorAll("button:disabled").length==2);for(let i of l)s(i)}else s(n[0],!0)}function g(e){let t=document.getElementById(e),n=t.value.split(",").filter(l=>l!="");return{excludeInput:t,excludeList:n}}function D(e,t){let{excludeInput:n,excludeList:l}=g(e);l.push(t),n.value=l.join(",")}function j(e,t){let{excludeInput:n,excludeList:l}=g(e),i=l.filter(o=>o!=t);n.value=i.join(",")}function C(){Array.from($("select[data-exclude]")).forEach(t=>{k(t)})}function k(e){let t=e.dataset.excludeId,n=Array.from(e.options),l=$(e).parents(".editable-form-field").find("li.list-group-item").get(),{excludeList:i}=g(t);n.forEach(o=>{o.disabled=!1,i.includes(o.text)&&(o.disabled=!0,o.selected=!1)}),l.forEach(o=>{s(o);let a=$(o).find("[data-select-value]")[0].textContent;i.includes(a)&&p(o)}),B(l[0].parentElement)}function q(){Array.from($("[data-fixed-toggler]")).filter(t=>t.checked).map(t=>{let n=document.getElementById(t.dataset.fixedToggler);y(t,n)})}jQuery(()=>{x=$("#new_field_template"),$("#add_new_field_button").on("click",e=>{A(e)}),$(".new_launcher").find(".editable-form-field").find(".btn-danger").on("click",e=>{v(e)}),$(".new_launcher").find(".editable-form-field").find(".btn-primary").on("click",e=>{E(e)}),$("[data-select-toggler]").on("click",e=>{w(e)}),$("[data-fixed-toggler]").on("click",e=>{F(e)}),$('[data-auto-environment-variable="name"]').on("keyup",e=>{_(e)}),C(),q()});
//# sourceMappingURL=/pun/sys/dashboard/assets/launcher_edit.js-58e3891e4c55e2076ea690af51ae8fc2251e913dba6af2c44b143fb783236351.map
//!
;
