var v=void 0,A=void 0,C=[],k={},E={},x=[],H=[],b={},L={},g={},F={},O={},_={},P=/[-_]([a-z])|([_-][0-9])|([\/])/g,K=!0;function T(e){return`${v}_${e.toLowerCase()}`}function U(e){let n=e.match(A);return n.length>=1?n[1]:""}function z(e){let n=e.toLowerCase(),t=n.charAt(0).toUpperCase(),l=n.slice(1).replace(P,function(s,i,o,a){if(i)return i.toUpperCase();if(o)return o.replace("_","-");if(a)return"_"});return`${t}${l}`}function f(e){if(e===void 0)return;let n=/([A-Z]{1}[a-z]*[0-9]*)|([^-_]+)/g;return e.match(n).filter(l=>l!="").map(l=>l.toLowerCase()).join("_")}function Z(e){e.each((n,t)=>{C.push(z(U(t.id)))})}function ae(e){v=e,A=new RegExp(`${v}_([\\w\\-]+)`);let n=$(`[id^=${v}]`);Z(n),n.each((t,l)=>{if(l.type=="select-one"){let s=`#${l.id} option`;$(s).each((o,a)=>{let c=$(`${s}[value='${a.value}']`).data(),d=Object.keys(c);d.length!==0&&d.forEach(r=>{if(r.startsWith("optionFor")){let u=r.replace(/^optionFor/,"");ee(h(u),l.id)}else if(r.startsWith("exclusiveOptionFor")){let u=r.replace(/^exclusiveOptionFor/,"");ne(h(u),l.id)}else r.startsWith("max")||r.startsWith("min")?N(l.id,a.value,r,c[r]):r.startsWith("set")?Q(l.id,a.value,r,c[r]):r.startsWith("hide")?y(l.id,a.value,r,c[r]):r.startsWith("label")&&J(l.id,a.value,r,c[r])})})}else if(l.type=="checkbox"){let s=$(l).data(),i=Object.keys(s);i.length!==0&&i.forEach(o=>{if(o.startsWith("hide")){let a=te(o);a!==void 0&&y(l.id,a.value,a.key,s[o])}})}}),K=!1}function y(e,n,t,l){let s=h(t.replace(/^hide/,""));O[e]===void 0&&(O[e]=new p(s,void 0)),O[e].put(s,n,l),b[e]===void 0&&(b[e]=[]),b[e].includes(s)||($(`#${e}`).on("change",a=>{V(a,s)}),b[e].push(s)),V({target:document.querySelector(`#${e}`)},s)}function G(e,n){let t=e[0].selectedIndex;return e[0].options[t].dataset[n]}function S(e,n,t){$(`label[for="${e}"]`)[0].innerHTML=G(n,t)}function J(e,n,t,l){let s=h(t.replace(/^label/,"")),i=$(`#${e}`);_[e]===void 0&&(_[e]=new p(s,void 0)),_[e].put(s,n,l),L[e]===void 0&&(L[e]=[]),L[e].includes(s)||i.on("change",a=>{S(s,i,t)}),S(s,i,t)}function N(e,n,t,l){e=String(e||""),l=parseInt(l);let s=ie(t),i=s.subjectId;if(i===void 0)return;let o=s.predicateId,a=s.predicateValue,c=`${e}_${i}`;g[c]===void 0&&(g[c]=new p(e,o)),g[c].put(n,a,{[se(t)]:l});let r=`${i}_${e}_${o}`;x.includes(r)||($(`#${e}`).on("change",m=>{w(m,i,o)}),x.push(r)),r=`${i}_${o}_${e}`,o!==void 0&&!x.includes(r)&&($(`#${o}`).on("change",m=>{w(m,i,e)}),x.push(r)),w({target:document.querySelector(`#${e}`)},i,o)}function Q(e,n,t,l){let s=t.replace(/^set/,""),i=String(h(s));if(i==="undefined")return;let o=`${i}_${e}`;F[o]===void 0&&(F[o]=new p(e,void 0)),F[o].put(n,void 0,l),H.includes(o)||($(`#${e}`).on("change",d=>{M(d,i)}),H.push(o)),M({target:document.querySelector(`#${e}`)},i)}function M(e,n){let t=e.target.value,l=`${n}_${e.target.id}`,s=F[l];if(s===void 0)return;let i=s.get(t,void 0);if(i!==void 0){let o=document.getElementById(n);o.type=="checkbox"?X(o,i):o.value=i}}function X(e,n){let t=e.value;n==t?e.checked=!0:e.checked=!1}var p=class{constructor(n,t){this.x=n,this.xIdxLookup={},this.y=t,this.yIdxLookup={},this.table=t===void 0?[]:[[]]}put(n,t,l){if(!n)return;n=f(n),t=f(t),this.xIdxLookup[n]===void 0&&(this.xIdxLookup[n]=Object.keys(this.xIdxLookup).length),t&&this.yIdxLookup[t]===void 0&&(this.yIdxLookup[t]=Object.keys(this.yIdxLookup).length);let s=this.xIdxLookup[n],i=this.yIdxLookup[t];if(this.table[s]===void 0&&(this.table[s]=t===void 0?void 0:[]),i===void 0)if(this.table[s]===void 0)this.table[s]=l;else{let o=this.table[s],a=l;typeof a=="string"&&typeof o=="string"?this.table[s]=a:this.table[s]=Object.assign(o,a)}else if(this.table[s][i]===void 0)this.table[s][i]=l;else{let o=this.table[s][i],a=l;typeof a=="string"&&typeof o=="string"?this.table[s][i]=a:this.table[s][i]=Object.assign(o,a)}}get(n,t){let l=this.xIdxLookup[f(n)],s=this.yIdxLookup[f(t)];if(this.table[l]!==void 0)return t===void 0?this.table[l]:this.table[l][s]}};function V(e,n){let t=Y(e),l=e.target.id,s;if($(`#${n}`).parents().each(function(o,a){var c=a.classList.values();for(let d of c)d.match("mb-3")&&(s=$(a))}),s===void 0||s.length<=0)return;let i=O[l].get(n,t);i===!1||i===void 0&&!K?s.show():i===!0&&s.hide()}function Y(e){return e.target.type=="checkbox"?e.target.checked?"checked":"unchecked":e.target.value}function w(e,n,t){let l,s,i=`${e.target.id}_${n}`;g[i]===void 0&&(i=`${t}_${n}`);let o=g[i];e.target.id==o.x?(l=f(e.target.value),s=f($(`#${t}`).val())):(s=f(e.target.value),l=f($(`#${t}`).val()));let a=$(`#${n}`),c=o.get(l,s),d={min:parseInt(a.attr("min")),max:parseInt(a.attr("max"))};["max","min"].forEach(u=>{c&&c[u]!==void 0&&a.attr(u,c[u])});let r=I(parseInt(a.val()),d,c);r!==void 0&&(a.attr("value",r),a.val(r))}function I(e,n,t){if(t!==void 0)return e===n.min?t.min:e===n.max?t.max:e<=t.min?t.min:e>=t.max?t.max:void 0}function R(e,n,t){let l=String(e||""),s=null;if(t=="optionFor"?(k[e]==null&&(k[e]=[]),s=k):t=="exclusiveOptionFor"&&(E[e]==null&&(E[e]=[]),s=E),l.length==0||s[e].includes(n))return;let i=$(`#${e}`);n&&i&&(s[e].push(n),i.on("change",o=>{t=="exclusiveOptionFor"?j(o,n):t=="optionFor"&&q(o,n)}),t=="exclusiveOptionFor"?j({target:document.querySelector(`#${e}`)},n):t=="optionFor"&&q({target:document.querySelector(`#${e}`)},n))}function ee(e,n){R(e,n,"optionFor")}function ne(e,n){R(e,n,"exclusiveOptionFor")}function te(e){let n=e.match(/^hide(\w+)When(\w+)$/);if(n!==void 0&&n.length&&n.length==3)return{key:n[1],value:n[2].toLowerCase()=="checked"?"checked":"unchecked"}}function ie(e){let n,t,l,s;e.startsWith("min")?n=e.replace(/^min/,""):e.startsWith("max")&&(n=e.replace(/^max/,""));let i=n.match(/^(\w+)For(\w+)$/);if(i==null)s=h(n);else if(i.length==3){let o=i[1],a=i[2];s=h(o);let c=a.split(/(?=[A-Z])/);if(c&&c.length>=2)if(c.length==2)t=h(c[0]),l=c[1];else{let d="",r=!1;c.forEach((u,m)=>{if(r)return;d=`${d}${u}`;let W=h(d);W!==void 0&&(r=!0,t=W,l=c.slice(m+1).join(""))})}}return{subjectId:s,predicateId:t,predicateValue:f(l)}}function se(e){return e.startsWith("min")?"min":e.startsWith("max")?"max":null}function h(e){if(elements=C.map(n=>{let t=e.match(`^${n}{1}`);if(t&&t.length>=1){let l=f(t[0]);return T(l)}}).filter(n=>n!==void 0),elements.length!=0){if(elements.length==1)return elements[0];if(elements.length>1){let n=f(e);return elements.filter(t=>t.endsWith(n))[0]}}}function B(e,n){return C.map(t=>{let l=e.match(`^${n}${t}`);if(l&&l.length>=1)return t}).filter(t=>t!==void 0)[0]}function le(e){return B(e,"optionFor")}function oe(e){return B(e,"exclusiveOptionFor")}function D(e,n,t){let l=[...document.querySelectorAll(`#${n} option`)],s;if(l.forEach(i=>{let o=!1;for(let a of Object.keys(i.dataset)){let c="";t=="optionFor"?c=le(a):t=="exclusiveOptionFor"&&(c=oe(a));let d=h(a.replace(new RegExp(`^${t}`),""));if(!a.startsWith(t)||d===void 0)continue;let r=z(document.getElementById(d).value);if(r.match(/^\d/)&&(r=`-${r}`),t=="optionFor"?o=i.dataset[`optionFor${c}${r}`]==="false":t=="exclusiveOptionFor"&&(o=i.dataset[`exclusiveOptionFor${c}${r}`]!=="true"),o)break}o?(i.selected&&(i.selected=!1,s=i.textContent),i.style.display="none",i.disabled=!0):(i.style.display="",i.disabled=!1)}),s!==void 0){let i=[...document.querySelectorAll(`#${n} option[value='${s}']`)],o;i.length>1&&i.forEach(a=>{if(a.style.display===""){o=a;return}}),o===void 0&&(i=document.querySelectorAll(`#${n} option`),i.forEach(a=>{o===void 0&&a.style.display===""&&(o=a)})),o!==void 0&&(o.selected=!0)}document.getElementById(n).dispatchEvent(new Event("change",{bubbles:!0}))}function q(e,n){D(e,n,"optionFor")}function j(e,n){D(e,n,"exclusiveOptionFor")}export{ae as makeChangeHandlers};
//# sourceMappingURL=/pun/sys/dashboard/assets/dynamic_forms.js-564cec7d389cfa7fe8777de815f18557e418e0567282db48c206c456ff396d24.map
//!
;
